# Chatbot-For-Psychotherapy
Use SFT, Preference Optimization (DPO, KTO, IPO) and RAG base on Llama3, Falcon and GPT to develop a chatbot simulate people with mental issues. Use SelfCheckGPT NLI and G-EVAL scores in LLM evaluation.

Detailed peformance analysis refer to: JiazhenLiu_Research.pdf

Dataset and models refer to: https://huggingface.co/JiazhenLiu01.  

Output and Evaluation refer to: https://drive.google.com/drive/folders/1wN5xfkBX7HkZ5Bk_wyjEFN4of0Fa8UpR?usp=sharing







## Analysis
Abstract - With the development of large language models (LLMs), these increasingly 
mature models are being applied across various interdisciplinary fields. The psychological 
domain is one of the significant areas for LLM application. To date, most LLMs have 
been used to simulate therapists, aiming to reduce the cost of psychotherapy and make it 
more accessible. This paper proposes the development of a bot that simulates people with 
mental issues. This innovation can aid in training interns and offer therapists deeper 
insights into their patients' experiences. The objective of my research is to create a bot 
that simulates a single patient's dialogue using LLMs, drawing from existing 
psychotherapy transcripts. This study utilizes three different training methods:
Supervised Fine-Tuning (SFT), Preference Tuning, and Retrieval-Augmented 
Generation (RAG) based on three types of LLMs (Llama3, Falcon, and GPT). Through 
both automated and human evaluations, the superiority of Preference Tuning and 
Retrieval-Augmented Generation (RAG) is demonstrated, proving their potential for 
large-scale application in psychotherapy chatbots. Additionally, the consistency between 
automated and human evaluations confirms the potential of SelfCheckGPT NLI and G-EVAL scores in LLM evaluation.
Index Terms – psychotherapy, chatbot, natural language processing, large language model, 
supervised fine-tuning, preference tuning, retrieval-augmented generation, large language 
model evaluation.


Index Terms – psychotherapy, chatbot, natural language processing, large language model,
supervised fine-tuning, preference tuning, retrieval-augmented generation, large language
model evaluation

![1](https://github.com/user-attachments/assets/39321e8c-1269-42c9-ba3b-54049d202b00)
![2](https://github.com/user-attachments/assets/64e94975-5be1-4cde-911c-71ca90c680d0)
![3](https://github.com/user-attachments/assets/18a0abbf-fd6c-4e1c-8865-157bf6ad39a5)
![4](https://github.com/user-attachments/assets/4d467e0f-fbd6-4406-aa47-aeb2d9a9e44c)
![5](https://github.com/user-attachments/assets/1ba994f6-a9d0-4b69-b48f-5f3b51280ec5)
![6](https://github.com/user-attachments/assets/fc92a6f7-ce75-409f-9e0e-34518fd250dc)
![7](https://github.com/user-attachments/assets/66ba7ed2-a2cf-413a-99f3-08f7455d08f7)
![8](https://github.com/user-attachments/assets/e6717c94-b360-4381-994d-d8a55950b77d)
![9](https://github.com/user-attachments/assets/7dfb6981-d279-4151-ae4c-9e2568780dde)
![10](https://github.com/user-attachments/assets/f6a03d30-1837-4504-9d0a-60e7044f0c1f)
![11](https://github.com/user-attachments/assets/6771807e-9968-41a1-bf46-33c35ab71cde)
![12](https://github.com/user-attachments/assets/2cd53bb3-10bc-452b-aa4f-1f335005d693)
![13](https://github.com/user-attachments/assets/05b31ae4-034c-4006-93b7-15fd2ce60d13)
![14](https://github.com/user-attachments/assets/e630188e-bdec-4fdf-ae5c-9faa0b21da39)
![15](https://github.com/user-attachments/assets/e39b8063-3e61-4d9f-931d-6b9167d20ffa)
![16](https://github.com/user-attachments/assets/f7c36fb6-0959-40f2-8620-aa2e95874fc7)
![17](https://github.com/user-attachments/assets/59b659be-8001-4050-9087-873e62cd0b48)
![18](https://github.com/user-attachments/assets/cdca11ac-05bb-436a-a807-8266be1d9177)
![19](https://github.com/user-attachments/assets/75bb9c2d-ddb8-4990-abf9-909a6e09696b)
![20](https://github.com/user-attachments/assets/6b398e60-2259-4322-9a48-bf96bc86d7d1)
![21](https://github.com/user-attachments/assets/67c06957-3dd5-4ef5-ae2a-3e935eee9e11)
![22](https://github.com/user-attachments/assets/42f4cb96-3109-4fcf-ae30-2e9011bf2f93)
![23](https://github.com/user-attachments/assets/a015d641-319e-4416-968b-6260e6b3a31e)
